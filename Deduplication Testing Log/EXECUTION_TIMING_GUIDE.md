# CDN å»é‡æ¸¬è©¦åŸ·è¡Œæ™‚æ©ŸæŒ‡å—

## ğŸ• **è…³æœ¬åŸ·è¡Œæ™‚æ©Ÿèªªæ˜**

### **å‹•æ…‹æ™‚é–“èª¿æ•´æ©Ÿåˆ¶**
`generate_dedup_test_logs.py` ä½¿ç”¨å‹•æ…‹æ™‚é–“ç”Ÿæˆï¼Œæ¯æ¬¡åŸ·è¡Œéƒ½æœƒï¼š
- åŸºæº–æ™‚é–“ = ç•¶å‰æ™‚é–“ - 30åˆ†é˜
- è™•ç†çª—å£ = åŸºæº–æ™‚é–“ ~ åŸºæº–æ™‚é–“ + 2å°æ™‚
- ç¢ºä¿æ‰€æœ‰ç”Ÿæˆçš„æ—¥èªŒéƒ½åœ¨ Log Processor çš„è™•ç†ç¯„åœå…§

### **åŸ·è¡Œæ™‚æ©Ÿç¯„ä¾‹**

#### **ä»Šå¤©åŸ·è¡Œ (2025-09-10 15:26:12)**
```
â° åŸºæº–æ™‚é–“ï¼š2025-09-10 14:56:12
ğŸ• è™•ç†çª—å£ï¼š14:56:12 ~ 16:56:12
ğŸ“Š æ—¥èªŒæ™‚é–“æˆ³ï¼š10/Sep/2025:15:05:12 é–‹å§‹
```

#### **æ˜å¤©åŸ·è¡Œ (2025-09-11 15:28:17)**
```
â° åŸºæº–æ™‚é–“ï¼š2025-09-11 14:58:17
ğŸ• è™•ç†çª—å£ï¼š14:58:17 ~ 16:58:17  
ğŸ“Š æ—¥èªŒæ™‚é–“æˆ³ï¼š11/Sep/2025:14:58:17 é–‹å§‹
```

## ğŸ“‹ **æ¸¬è©¦åŸ·è¡Œå»ºè­°**

### **1. ç«‹å³æ¸¬è©¦ (æ¨è–¦)**
```bash
# ç”Ÿæˆä¸¦ç«‹å³åŸ·è¡Œæ¸¬è©¦
python3 generate_dedup_test_logs.py
# ç«‹å³ä¸Šå‚³åˆ° S3 ä¸¦å•Ÿå‹• Log Processor
```
**å„ªé»ï¼š** æ™‚é–“æˆ³æœ€æ–°ï¼Œè™•ç†çª—å£å……è¶³

### **2. å»¶å¾Œæ¸¬è©¦**
```bash
# ä»»ä½•æ™‚å€™é‡æ–°ç”Ÿæˆ
python3 generate_dedup_test_logs.py
# è…³æœ¬æœƒè‡ªå‹•èª¿æ•´ç‚ºç•¶å‰æœ€ä½³æ™‚é–“
```
**å„ªé»ï¼š** éˆæ´»æ€§é«˜ï¼Œè‡ªå‹•é©æ‡‰

### **3. å®šæ™‚æ¸¬è©¦**
```bash
# è¨­å®š cron job æ¯å¤©åŸ·è¡Œ
0 14 * * * cd /path/to/logs && python3 generate_dedup_test_logs.py
```
**å„ªé»ï¼š** è‡ªå‹•åŒ–ï¼ŒæŒçºŒé©—è­‰

## âš ï¸ **ç‰¹æ®Šæ¸¬è©¦æƒ…æ³**

### **TTL çœŸå¯¦éæœŸæ¸¬è©¦**

**æ–¹æ³• 1ï¼šåˆ†æ‰¹åŸ·è¡Œ**
```bash
# ç¬¬ä¸€æ‰¹ï¼šç”Ÿæˆä¸¦è™•ç†
python3 generate_dedup_test_logs.py
# ä¸Šå‚³ test_logs_ttl_boundary_batch1.log

# ç­‰å¾… 2+ å°æ™‚å¾Œ
# ç¬¬äºŒæ‰¹ï¼šé‡æ–°ç”Ÿæˆç•¶å‰æ™‚é–“çš„ç¬¬äºŒæ‰¹
# æ‰‹å‹•ä¿®æ”¹è…³æœ¬æˆ–ä½¿ç”¨ç¬¬äºŒæ‰¹æª”æ¡ˆ
```

**æ–¹æ³• 2ï¼šæ‰‹å‹•èª¿æ•´ Redis TTL**
```bash
# è¨­å®šçŸ­ TTL é€²è¡Œå¿«é€Ÿæ¸¬è©¦
redis-cli CONFIG SET timeout 300  # 5åˆ†é˜ TTL
```

### **ä¸¦ç™¼æ¸¬è©¦æœ€ä½³æ™‚æ©Ÿ**
```bash
# ç¢ºä¿æ‰€æœ‰è™•ç†å™¨åŒæ™‚åŸ·è¡Œ
python3 generate_dedup_test_logs.py
# åŒæ™‚å•Ÿå‹• 5 å€‹ Log Processor å¯¦ä¾‹
```

## ğŸ¯ **æ™‚é–“æˆ³é©—è­‰æª¢æŸ¥**

### **åŸ·è¡Œå‰æª¢æŸ¥**
```bash
# æª¢æŸ¥ç•¶å‰æ™‚é–“
date

# æª¢æŸ¥ç”Ÿæˆçš„æ™‚é–“æˆ³ç¯„åœ
python3 -c "
from datetime import datetime, timedelta
now = datetime.now()
base = now - timedelta(minutes=30)
print(f'è™•ç†çª—å£: {base.strftime(\"%H:%M\")} ~ {(base + timedelta(hours=2)).strftime(\"%H:%M\")}')
"
```

### **åŸ·è¡Œå¾Œé©—è­‰**
```bash
# æª¢æŸ¥ç”Ÿæˆæª”æ¡ˆçš„æ™‚é–“æˆ³
head -10 test_logs_basic_dedup_full.log | grep -o '"[0-9][0-9]/[A-Z][a-z][a-z]/[0-9][0-9][0-9][0-9]:[0-9][0-9]:[0-9][0-9]:[0-9][0-9]'

# ç¢ºèªåœ¨è™•ç†çª—å£å…§
python3 -c "
from datetime import datetime
import re

with open('test_logs_basic_dedup_full.log', 'r') as f:
    content = f.read()
    
timestamps = re.findall(r'\"(\d{2}/\w{3}/\d{4}:\d{2}:\d{2}:\d{2})', content)
if timestamps:
    first_ts = datetime.strptime(timestamps[0], '%d/%b/%Y:%H:%M:%S')
    print(f'ç¬¬ä¸€ç­†è¨˜éŒ„æ™‚é–“: {first_ts}')
    print(f'ç•¶å‰æ™‚é–“: {datetime.now()}')
    diff = datetime.now() - first_ts
    print(f'æ™‚é–“å·®: {diff.total_seconds()/3600:.1f} å°æ™‚')
    if diff.total_seconds() < 7200:  # 2å°æ™‚
        print('âœ… åœ¨è™•ç†çª—å£å…§')
    else:
        print('âŒ è¶…å‡ºè™•ç†çª—å£')
"
```
## **ç”¢å‡ºæª”æ¡ˆèªªæ˜**
| æª”æ¡ˆåç¨± | å¤§å° | ç”¨é€” |
|----------|----------|----------|
| test_logs_basic_dedup_full.log | 513KB | åŸºç¤å»é‡æ¸¬è©¦ |
| test_logs_concurrent_processor1_full.log | 511KB | ä¸¦ç™¼å»é‡æ¸¬è©¦ |
| test_logs_high_frequency_dedup_full.log | 5.6MB | é«˜é »é‡è¤‡æ¸¬è©¦ |
| test_logs_ttl_boundary_batch1.log | 53KB | TTL é‚Šç•Œæ¸¬è©¦ |

## ğŸ“Š **ä¸åŒæ™‚æ©ŸåŸ·è¡Œçš„å½±éŸ¿**

| åŸ·è¡Œæ™‚æ©Ÿ | è™•ç†çª—å£ | æ¸¬è©¦æ•ˆæœ | å»ºè­°ä½¿ç”¨ |
|----------|----------|----------|----------|
| ç«‹å³åŸ·è¡Œ | å……è¶³ (1.5-2å°æ™‚) | âœ… æœ€ä½³ | æ­£å¼æ¸¬è©¦ |
| 1å°æ™‚å¾Œ | é©ä¸­ (0.5-1.5å°æ™‚) | âœ… è‰¯å¥½ | è£œå……æ¸¬è©¦ |
| 2å°æ™‚å¾Œ | éœ€é‡æ–°ç”Ÿæˆ | âš ï¸ éœ€æ›´æ–° | é‡æ–°ç”Ÿæˆ |
| éš”å¤©åŸ·è¡Œ | è‡ªå‹•èª¿æ•´ | âœ… è‰¯å¥½ | æ—¥å¸¸æ¸¬è©¦ |

## ğŸš€ **æœ€ä½³å¯¦å‹™å»ºè­°**

1. **æ¸¬è©¦å‰ç”Ÿæˆ** - åœ¨é–‹å§‹æ¸¬è©¦å‰æ‰åŸ·è¡Œè…³æœ¬
2. **é©—è­‰æ™‚é–“æˆ³** - ç¢ºèªç”Ÿæˆçš„æ™‚é–“æˆ³åœ¨è™•ç†çª—å£å…§  
3. **ä¿ç•™å½ˆæ€§** - éš¨æ™‚å¯é‡æ–°ç”Ÿæˆé©æ‡‰ç•¶å‰æ™‚é–“
4. **è¨˜éŒ„åŸ·è¡Œæ™‚é–“** - åœ¨æ¸¬è©¦å ±å‘Šä¸­è¨˜éŒ„ç”Ÿæˆå’ŒåŸ·è¡Œæ™‚é–“

é€™æ¨£çš„è¨­è¨ˆç¢ºä¿äº†æ¸¬è©¦çš„æ™‚æ•ˆæ€§å’Œå¯é‡è¤‡æ€§ï¼
